<div
  class="min-h-screen bg-gray-50 flex flex-col justify-center py-12 sm:px-6 lg:px-8"
>
  <div class="sm:mx-auto sm:w-full sm:max-w-md">
    <div class="text-center">
      <h2 class="text-3xl font-bold text-gray-900">Join BookBuddy</h2>
      <p class="mt-2 text-sm text-gray-600">
        Create your account to start tracking and sharing books
      </p>
    </div>
  </div>

  <div class="mt-8 sm:mx-auto sm:w-full sm:max-w-md">
    <div class="bg-white py-8 px-4 shadow sm:rounded-lg sm:px-10">
      <form
        class="space-y-6"
        [formGroup]="registerForm"
        (ngSubmit)="onSubmit()"
      >
        <div>
          <label for="username" class="block text-sm font-medium text-gray-700">
            Username
          </label>
          <div class="mt-1">
            <input
              [class.border-red-500]="isUsernameValid"
              id="username"
              formControlName="username"
              type="text"
              class="appearance-none block w-full px-3 py-2 border border-gray-300 rounded-md placeholder-gray-400 focus:outline-none focus:ring-blue-500 focus:border-blue-500 sm:text-sm"
              placeholder="Choose a username"
            />
          </div>
          @if (isUsernameValid) {
          <p class="text-red-500 text-sm mt-1">{{ usernameErrorMessage }}</p>
          }
        </div>

        <div>
          <label for="email" class="block text-sm font-medium text-gray-700">
            Email address
          </label>
          <div class="mt-1">
            <input
              [class.border-red-500]="isEmailValid"
              id="email"
              formControlName="email"
              type="email"
              class="appearance-none block w-full px-3 py-2 border border-gray-300 rounded-md placeholder-gray-400 focus:outline-none focus:ring-blue-500 focus:border-blue-500 sm:text-sm"
              placeholder="Enter your email"
            />
          </div>
          @if (isEmailValid) {
          <p class="text-red-500 text-sm mt-1">{{ emailErrorMessage }}</p>
          }
        </div>

        <div formGroupName="passwords">
          <div>
            <label
              for="password"
              class="block text-sm font-medium text-gray-700"
            >
              Password
            </label>
            <div class="mt-1">
              <input
                [class.border-red-500]="isPasswordValid"
                id="password"
                formControlName="password"
                type="password"
                class="appearance-none block w-full px-3 py-2 border border-gray-300 rounded-md placeholder-gray-400 focus:outline-none focus:ring-blue-500 focus:border-blue-500 sm:text-sm"
                placeholder="Create a password"
              />
            </div>
            <p class="mt-1 text-xs text-gray-500">
              Password must be at least 8 characters long
            </p>
            @if (password?.value) {
            <div class="mt-2">
              <div class="w-full h-2 rounded bg-gray-200 overflow-hidden">
                <div
                  class="h-full transition-all duration-300"
                  [ngClass]="{
                    'bg-red-500 w-1/3': passwordStrength === 'weak',
                    'bg-yellow-500 w-2/3': passwordStrength === 'medium',
                    'bg-green-500 w-full': passwordStrength === 'strong'
                  }"
                ></div>
              </div>
              <small
                class="block mt-1 font-medium"
                [ngClass]="{
                  'text-red-500': passwordStrength === 'weak',
                  'text-yellow-500': passwordStrength === 'medium',
                  'text-green-500': passwordStrength === 'strong'
                }"
              >
                {{ passwordStrengthMessage }}
              </small>
            </div>
            } @if (isPasswordValid) {
            <p class="text-red-500 text-sm mt-1">{{ passwordErrorMessage }}</p>
            }
          </div>

          <div>
            <label
              for="confirmPassword"
              class="block text-sm font-medium text-gray-700"
            >
              Confirm Password
            </label>
            <div class="mt-1">
              <input
                [class.border-red-500]="isPasswordValid"
                id="confirmPassword"
                formControlName="rePassword"
                type="password"
                class="appearance-none block w-full px-3 py-2 border border-gray-300 rounded-md placeholder-gray-400 focus:outline-none focus:ring-blue-500 focus:border-blue-500 sm:text-sm"
                placeholder="Confirm your password"
              />
            </div>
            @if (isPasswordValid) {
            <p class="text-red-500 text-sm mt-1">
              {{ rePasswordErrorMessage }}
            </p>
            }
          </div>
        </div>

        <div class="flex items-center">
          <input
            id="agree-terms"
            formControlName="agreeTerms"
            type="checkbox"
            class="h-4 w-4 text-blue-600 focus:ring-blue-500 border-gray-300 rounded"
          />
          <label for="agree-terms" class="ml-2 block text-sm text-gray-900">
            I agree to the
            <a href="#" class="text-blue-600 hover:text-blue-500"
              >Terms of Service</a
            >
            and
            <a href="#" class="text-blue-600 hover:text-blue-500"
              >Privacy Policy</a
            >
          </label>
        </div>
        @if (isTermsAgreed) {
        <p class="text-red-500 text-sm mt-1">{{ agreeTermsErrorMessage }}</p>
        }

        <div>
          <button
            type="submit"
            [disabled]="registerForm.invalid || isSubmitting"
            class="w-full flex justify-center items-center py-2 px-4 border border-transparent rounded-md shadow-sm text-sm font-medium text-white bg-blue-600 hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 disabled:opacity-50 disabled:cursor-not-allowed"
          >
            @if (isSubmitting) {
            <svg
              class="animate-spin h-5 w-5 mr-2 text-white"
              xmlns="http://www.w3.org/2000/svg"
              fill="none"
              viewBox="0 0 24 24"
            >
              <circle
                class="opacity-25"
                cx="12"
                cy="12"
                r="10"
                stroke="currentColor"
                stroke-width="4"
              ></circle>
              <path
                class="opacity-75"
                fill="currentColor"
                d="M4 12a8 8 0 018-8v8H4z"
              ></path>
            </svg>
            Creating... } @else { Create Account }
          </button>
        </div>
      </form>

      <div class="mt-6">
        <div class="relative">
          <div class="absolute inset-0 flex items-center">
            <div class="w-full border-t border-gray-300"></div>
          </div>
          <div class="relative flex justify-center text-sm">
            <span class="px-2 bg-white text-gray-500">Or continue with</span>
          </div>
        </div>

        <div class="mt-6">
          <button
            type="button"
            (click)="continueWithGoogle()"
            [disabled]="isGoogleLoading"
            class="w-full inline-flex items-center justify-center gap-3 py-2 px-4 border border-gray-300 rounded-md shadow-sm bg-white text-sm font-medium text-gray-700 hover:bg-gray-50 disabled:opacity-50 disabled:cursor-not-allowed"
          >
            <svg class="w-5 h-5" viewBox="0 0 48 48">
              <path
                fill="#FFC107"
                d="M43.6 20.5H42V20H24v8h11.3C33.8 32.2 29.4 35 24 35c-6.6 0-12-5.4-12-12s5.4-12 12-12c3.1 0 5.9 1.2 8 3.1l5.7-5.7C34.6 5.1 29.6 3 24 3 12.9 3 4 11.9 4 23s8.9 20 20 20 19.2-8.7 19.2-19.5c0-1.3-.1-2.2-.6-3z"
              />
              <path
                fill="#FF3D00"
                d="M6.3 14.7l6.6 4.8C14.5 16.5 18.8 13 24 13c3.1 0 5.9 1.2 8 3.1l5.7-5.7C34.6 5.1 29.6 3 24 3 16 3 9.1 7.4 6.3 14.7z"
              />
              <path
                fill="#4CAF50"
                d="M24 43c5.3 0 10.2-2 13.8-5.3l-6.4-5.2C29.2 33.7 26.8 35 24 35c-5.3 0-9.8-3.5-11.4-8.2l-6.6 5.1C8.8 38.6 15.8 43 24 43z"
              />
              <path
                fill="#1976D2"
                d="M43.6 20.5H42V20H24v8h11.3c-1.1 3.3-4.1 5.8-7.3 6.5l6.4 5.2C37.4 36.6 40 30.6 40 24c0-1.3-.1-2.2-.4-3.5z"
              />
            </svg>
            <span>
              @if (isGoogleLoading) { Connectingâ€¦ } @else { Continue with Google
              }
            </span>
          </button>
        </div>
      </div>

      <div class="mt-6 text-center">
        <p class="text-sm text-gray-600">
          Already have an account?
          <a
            routerLink="/login"
            class="font-medium text-blue-600 hover:text-blue-500"
          >
            Sign in here
          </a>
        </p>
      </div>
    </div>
  </div>
</div>
